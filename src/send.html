<div class="dashboard">
    <div class="dashboard-menu close">
        <div class="dashboard-menu-logo">
		            <a href="#/dashboard.html">
		                <div class="svg--logo-wallet"></div>
            </a>
        </div>
        <div class="dashboard-menu-burger">
            <div class="svg svg--menu-open"></div>
            <div class="svg svg--menu-close"></div>
        </div>
<div id="dashboard-current" class="dashboard-current"></div>
<script>
var current_time = XMR_DATE.getTime();

function update_xmr_value()
{
    xmr_updated_value = XMR_DATE.getTime();
    if(session_id)
    {
        $.ajax({
            url: 'getprice.php',
            dataType: 'json'
        }).done(function(response){
                var obj = response;
                if(obj)
                {
                    if(obj.hasOwnProperty('USD'))
                    {
                        var currentusdprice = cnUtil.parseMoney(obj['USD'].toString());
                        last_usd_value_real = parseFloat(obj['USD'].toString());
                        last_usd_value = currentusdprice.divide('1000000000000');
                        last_xmr_value = "<div class=\"dashboard-current-item\"><span><strong>1 XMR</strong> = $" + (obj['USD']*1.0) + "</span> USD</div>" + "<div class=\"dashboard-current-item\"><span><strong>1 XMR</strong> = " + (obj['BTC']*1.0) + " </span>BTC</div>";
                        document.getElementById("dashboard-current").innerHTML = last_xmr_value;
                        setTimeout(update_xmr_value, 60000);
                    }
                    else
                    {
                     setTimeout(update_xmr_value, 1000);
                    }
                }
                else
                {
                    setTimeout(update_xmr_value, 1000);
                }
            }).fail(function(){
            setTimeout(update_xmr_value, 1000);
        });
    }
    else
    {
        setTimeout(update_xmr_value, 1000);
    }
}
if(current_time - xmr_updated_value > 60000)
{
    update_xmr_value();
}
else
{   
    document.getElementById("dashboard-current").innerHTML = last_xmr_value;
}

</script>
<div class="dashboard-nav">
    <nav>
        <ul>
            <li>
                <a href="#/dashboard.html">
                    <span class="svg-wrap"><span class="svg--overview"></span></span>
                    <span class="nav-text"><span data-i18n="overview">Overview</span></span>
                </a>
            </li>
            <li>
                <a href="#/transactions.html">
                    <span class="svg-wrap"><span class="svg--transacrions"></span></span>
                    <span class="nav-text"><span data-i18n="transactions">Transactions</span></span>
                </a>
            </li>
            <li>
                <a href="#/send.html" class="active">
                    <span class="svg-wrap"><span class="svg--send"></span></span>
                    <span class="nav-text"><span data-i18n="send">Send</span></span>
                </a>
            </li>
            <li>
                <a href="#/receive.html">
                    <span class="svg-wrap"><span class="svg--receive"></span></span>
                    <span class="nav-text"><span data-i18n="receive">Receive</span></span>
                </a>
            </li>
        </ul>
        <hr/>
        <ul>
            <li>
                <a href="#/account.html">
                    <span class="svg-wrap"><span class="svg--profile"></span></span>
                    <span class="nav-text"><span data-i18n="account">Account</span></span>
                </a>
            </li>
            <li>
                <a href="#/support_login.html">
                    <span class="svg-wrap"><span class="svg--support"></span></span>
                    <span class="nav-text"><span data-i18n="support">Support</span></span>
                </a>
            </li>
            <li>
                <a id="logout" href="#">
                    <span class="svg-wrap"><span class="svg--quit"></span></span>
                    <span class="nav-text"><span data-i18n="quit">Quit</span></span>
                </a>
                <script>
                $("#logout").click(function(e)
                {
                    e.preventDefault();
                    var url = "logout.php";

                    $.ajax({
                           type: "POST",
                           url: url,
                           data: {
                            session_id: session_id
                           }
                         });  
                    window.location.href = '/';
                });
                </script>
            </li>
        </ul>
    </nav>
</div>            </div>
    <div class="dashboard-root">
        <div class="dashboard-body-wrap">
            <div class="dashboard-body">
                <div class="dashboard-body-header">
                    <div class="header-group">
                        <div class="header-title"><span data-i18n="title_send">Send</span></div>
                        <div class="header-subtitle">
                            <span class="header-subtitle-text"><span data-i18n="title_sub_send">Transfer Monero to anyone, anywhere.</span></span>
                                                    </div>
                    </div>
                                            <div id="xmrbal_full" class="header-balance" style="cursor:pointer;">
                            <div id="xmrbal_logo" class="header-balance-logo" style="cursor:pointer;">
                                <span id="curimg" class="svg svg--monero-white"></span>
                            </div>
                            <div class="header-balance-hr"></div>
                            <div class="header-balance-current">
                                <div id="xmr_balance" class="header-balance-count" style="cursor:pointer;"><div class="wave"><span class="dot"></span><span class="dot"></span><span class="dot"></span></div></div>
                                <div id="xmr_unlocked_balance" class="header-balance-desc" style="cursor:pointer;">XMR Balance</div>
                            </div>
                            <script>
                            var current_time = XMR_DATE.getTime();
                            
                            function update_xmr_balance_helper(data)
                            {
                                
                                var check_timeout = 10000;
                                var returned_data = [];
                                if(data != "")
                                {
                                    returned_data = data.split(":");
                                }
                                else
                                {
                                    returned_data.push("!");
                                    returned_data.push("!");
                                }
                                if(returned_data.length == 2)
                                {
                                    if(returned_data[0] != returned_data[1])
                                    {
                                        real_xmr_balance = JSBigInt(returned_data[0]);
                                        real_xmr_unlocked_balance = JSBigInt(returned_data[1]);
                                        if(show_currency == 1)
                                        {
                                            last_xmr_balance = "$" + parseFloat(moneroBalance(real_xmr_balance.multiply(last_usd_value))).toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2});
                                            last_xmr_unlocked_balance = "$" + parseFloat(moneroBalance(real_xmr_unlocked_balance.multiply(last_usd_value))).toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2}) + " Unlocked";
                                        }
                                        else
                                        {
                                            last_xmr_balance = (moneroBalance(real_xmr_balance) + " XMR");
                                            last_xmr_unlocked_balance = (moneroBalance(real_xmr_unlocked_balance) + " Unlocked");
                                        }
                                    }
                                    else
                                    {
                                        if(returned_data[0] != "!")
                                        {
                                            real_xmr_balance = JSBigInt(returned_data[0]);
                                            real_xmr_unlocked_balance = JSBigInt(returned_data[0]);
                                        }                                                  
                                        if(show_currency == 1)
                                        {
                                            last_xmr_balance = "$" + parseFloat(moneroBalance(real_xmr_balance.multiply(last_usd_value))).toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2});
                                            last_xmr_unlocked_balance = "USD Balance";
                                        }
                                        else
                                        {
                                            last_xmr_balance = moneroBalance(real_xmr_balance);
                                            last_xmr_unlocked_balance = "XMR Balance";
                                        }
                                    }
                                    var finalshowbalsup = "";

                                    var finalshowbal = last_xmr_balance;
                                    if(show_currency == 0 && last_xmr_balance.length > 7)
                                    {
                                        finalshowbalsup = last_xmr_balance.substr(7);
                                        finalshowbal = last_xmr_balance.substr(0, 7)  + "<sup class=\"header-balance-pennies\">" + finalshowbalsup + "</sup>";
                                    }
                                    if(show_currency == 1)
                                    {
                                        if($('#curimg').hasClass('svg--monero-white'))
                                        {
                                            $('#curimg').removeClass('svg--monero-white').addClass('svg--usd-white');
                                        }
                                    }
                                    else
                                    {
                                        if($('#curimg').hasClass('svg--usd-white'))
                                        {
                                            $('#curimg').removeClass('svg--usd-white').addClass('svg--monero-white');
                                        }
                                    }
                                    document.getElementById("xmr_balance").innerHTML = finalshowbal;
                                    document.getElementById("xmr_unlocked_balance").innerHTML = last_xmr_unlocked_balance;
                                    last_xmr_bal_init = 1;
                                }
                                else
                                {
                                    check_timeout = 1000;
                                }
                                
                                return check_timeout;
                                
                            }
                            
                            function update_xmr_height()
                            {
                                if(session_id)
                                {
                                    $.ajax({
                                        type: "POST",
                                        url: '/getheightsync.php',
                                        data: {
                                           session_id: session_id,
                                        }
                                    }).done(function(data){
                                            if(data != '0')
                                            {
                                                
                                                if(data == '-1')
                                                {
                                                    xmr_updating_height = 0;
                                                    window.location.hash = "#/login.html";
                                                    load_page();
                                                    //setTimeout(update_xmr_height, 1000);
                                                }
                                                else
                                                {
                                                
                                                    var returned_main = data.split(":");
                                                    var end_main = parseInt(returned_main[1]);
                                                    
                                                    if(end_main == 1)
                                                    {
                                                        load_page();
                                                        setTimeout(update_xmr_height, 1000);
                                                    }
                                                    else
                                                    {
                                                        var returned_data = data.split("/");
                                                        
                                                        var beg = parseInt(returned_data[0]);
                                                        var end = parseInt(returned_data[1]);
                                                        
                                                        if(beg != 0 && end != 0)
                                                        {
                                                            wallet_height_beg = beg;
                                                            wallet_height_end = end;
                                                        }
                                                        
                                                        if(beg != end)
                                                        {
                                                            setTimeout(update_xmr_height, 1000);
                                                        }
                                                        else
                                                        {
                                                            setTimeout(update_xmr_height, 5000);
                                                        }
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                setTimeout(update_xmr_height, 5000);
                                            }
                                            
                                    }).fail(function()
                                    {
                                        setTimeout(update_xmr_height, 1000);
                                    });
                                }
                                else
                                {
                                    setTimeout(update_xmr_height, 1000);
                                }
                            }
                            if(xmr_updating_height == 0)
                            {   
                                xmr_updating_height = 1;
                                update_xmr_height();
                            }
                            
                            function update_xmr_balance(timeout)
                            {
                                if(timeout == 2)
                                {
                                    update_xmr_balance_helper("");
                                }
                                else
                                {
                                    xmr_balance_updated_value = XMR_DATE.getTime();
                                    if(session_id && xmr_canget_transactions == 1 && xmr_canget_balance == 1 && wallet_height_beg == wallet_height_end && wallet_height_beg != 0)
                                    {
                                        $.ajax({
                                            type: "POST",
                                            url: '/getbalance.php',
                                            data: {
                                               session_id: session_id,
                                            }
                                        }).done(function(data){
                                                var check_timeout = update_xmr_balance_helper(data);
                                                if(timeout == 1)
                                                {
                                                    setTimeout(function(){ update_xmr_balance(1) }, check_timeout);
                                                }
                                                
                                        }).fail(function()
                                        {
                                            if(timeout == 1)
                                            {
                                                setTimeout(function(){ update_xmr_balance(1) }, 1000);
                                            }
                                        });
                                    }
                                    else
                                    {
                                        if(timeout == 1)
                                        {
                                            setTimeout(function(){ update_xmr_balance(1) }, 1000);
                                        }
                                    }
                                }
                            }
                            
                            //$("#xmr_balance").unbind().click(function(){ if(show_currency == 0 && last_usd_value.compare("0") > 0){ show_currency = 1; }else{ show_currency = 0; } update_xmr_balance(2); });
                            //$("#xmr_unlocked_balance").unbind().click(function(){ if(show_currency == 0 && last_usd_value.compare("0") > 0){ show_currency = 1; }else{ show_currency = 0; } update_xmr_balance(2); });
                            //$("#xmrbal_logo").unbind().click(function(){ if(show_currency == 0 && last_usd_value.compare("0") > 0){ show_currency = 1; }else{ show_currency = 0; } update_xmr_balance(2); });
                            $("#xmrbal_full").unbind().click(function(){ if(show_currency == 0 && last_usd_value.compare("0") > 0){ show_currency = 1; }else{ show_currency = 0; } update_xmr_balance(2); });
                            function update_xmr_outputs()
                            {
                                if(session_id && wallet_height_beg == wallet_height_end && wallet_height_beg != 0)
                                {
                                    $.ajax({
                                        type: "POST",
                                        url: '/getoutputs.php',
                                        data: {
                                           session_id: session_id,
                                        }
                                    }).done(function(data){
                                    
                                            var check_timeout = 60000;
                                           
                                            try
                                            {
                                                
                                                if(data != "0")
                                                {
                                                    if(data != "1")
                                                    {
                                                        var finaldata = JSON.parse(data);
                                                        if(finaldata)
                                                        {
                                                            var finalkeyimages = {}; 
                                                            finalkeyimages.content = new Array();
                                                            var donotprocessthis = 0;
                                                            for(var i = 0; i < finaldata.length-1; i++)
                                                            {
                                                                if(finaldata[i] != null)
                                                                {
                                                                    if(typeof finaldata[i].tx_pubkeys !== 'undefined' && finaldata[i].tx_pubkeys.length > 0)
                                                                    {
                                                                        finalkeyimages.content.push({});
                                                                        var image_ret;
                                                                        
                                                                        try
                                                                        {
                                                                            image_ret = cnUtil.generate_key_image_helper_rct(main_keys, finaldata[i].tx_pubkeys[0], finaldata[i].m_internal_output_index, finaldata[i].m_mask);
                                                                        }
                                                                        catch(e)
                                                                        {
                                                                            console.log("trying to get outputs again...");
                                                                            donotprocessthis = 1;
                                                                            check_timeout = 1000;
                                                                            break;
                                                                        }
                                                                        
                                                                        var src_keys = [];
                                                                        src_keys.push(image_ret.in_ephemeral.pub);
                                                   
                                                                        var sig_ret = cnUtil.generate_ring_signature(image_ret.image, image_ret.image, src_keys, image_ret.in_ephemeral.sec, 0);
                                                                        
                                                                        finalkeyimages.content[finalkeyimages.content.length-1].key_image = image_ret.image;
                                                                        finalkeyimages.content[finalkeyimages.content.length-1].signature = sig_ret;
                                                                    }
                                                                    else
                                                                    {
                                                                        console.log("invalid transactions, please contact support");
                                                                        break;
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    if(finaldata.length == 1)
                                                                    {
                                                                        xmr_canget_balance = 1;
                                                                    }
                                                                    else
                                                                    {
                                                                        console.log("invalid transactions, please contact support");
                                                                        break;
                                                                    }
                                                                }
                                                                
                                                            }
                                                            if(donotprocessthis == 0 && finalkeyimages.content.length == finaldata.length-1)
                                                            {
                                                                if(finalkeyimages.content.length == 0)
                                                                {
                                                                    xmr_canget_balance = 1;
                                                                    setTimeout(update_xmr_outputs, check_timeout);
                                                                }
                                                                else
                                                                {
                                                                    finalsend = JSON.stringify(finalkeyimages);
                                                                    
                                                                    $.ajax({
                                                                        url: '/updateoutputs.php',
                                                                        type: 'POST',
                                                                        data: { session_id: session_id,
                                                                                keys : finalsend }
                                                                    }).done(function(data){ if(data == "0"){ check_timeout = 1000; setTimeout(update_xmr_outputs, check_timeout); return; }  if(finaldata[finaldata.length-1].extra == 1){ check_timeout = 100; }else{ xmr_canget_balance = 1; } setTimeout(update_xmr_outputs, check_timeout); }).fail(function(){ check_timeout = 1000; console.log("failed to update outputs"); setTimeout(update_xmr_outputs, check_timeout); });
                                                                }
                                                            }
                                                            else
                                                            {
                                                                setTimeout(update_xmr_outputs, check_timeout);
                                                            }
                                                        }
                                                        else
                                                        {
                                                            check_timeout = 1000;
                                                            setTimeout(update_xmr_outputs, check_timeout);
                                                        }
                                                    }
                                                    else
                                                    {
                                                        xmr_canget_balance = 1;
                                                        setTimeout(update_xmr_outputs, check_timeout);
                                                    }
                                                    
                                                }
                                                else
                                                {
                                                    check_timeout = 1000;
                                                    setTimeout(update_xmr_outputs, check_timeout);
                                                }
                                            }
                                            catch(e)
                                            {
                                                check_timeout = 1000;
                                            }
                                            
                                        
                                            
                                    }).fail(function()
                                    {
                                        setTimeout(update_xmr_outputs, 1000);
                                    });
                                }
                                else
                                {
                                    setTimeout(update_xmr_outputs, 1000);
                                }
                            }
                            
                            if(xmr_alreadyupdating_balance == 0)
                            {
                                xmr_alreadyupdating_balance = 1;
                                update_xmr_balance(1);
                            }
                            else
                            {   
                                if(last_xmr_bal_init == 1)
                                {
                                    var finalshowbalsup = "";

                                    var finalshowbal = last_xmr_balance;
                                    if(show_currency == 0 && last_xmr_balance.length > 7)
                                    {
                                        finalshowbalsup = last_xmr_balance.substr(7);
                                        finalshowbal = last_xmr_balance.substr(0, 7)  + "<sup class=\"header-balance-pennies\">" + finalshowbalsup + "</sup>";
                                    }
                                    if(show_currency == 1)
                                    {
                                        if($('#curimg').hasClass('svg--monero-white'))
                                        {
                                            $('#curimg').removeClass('svg--monero-white').addClass('svg--usd-white');
                                        }
                                    }
                                    else
                                    {
                                        if($('#curimg').hasClass('svg--usd-white'))
                                        {
                                            $('#curimg').removeClass('svg--usd-white').addClass('svg--monero-white');
                                        }
                                    }
                                    document.getElementById("xmr_balance").innerHTML = finalshowbal;
                                    document.getElementById("xmr_unlocked_balance").innerHTML = last_xmr_unlocked_balance;
                                }
                            }
                            
                            if(xmr_alreadyupdating_outputs == 0)
                            {
                                xmr_alreadyupdating_outputs = 1;
                                update_xmr_outputs();
                            }
                            
                            </script>
                        </div>
                                    </div>
                <div class="dashboard-body-content">
                        <script>document.title = "Send Monero | xmrwallet.com";</script>
    <script>
    if(typeof session_id === 'undefined' || session_id === null || xmrwallet_spendkey == '' || xmrwallet_viewkey == '' || xmrwallet_address == '' || session_id == '')
    {
        window.location.href = "/";
    }
    </script>
    
    <dialog id="dialog_send" class="dashboard-dialog">
        <div class="dashboard-dialog-title">
            Confirmation
        </div>
        <div class="dashboard-dialog-body">
            <div class="dashboard-dialog-value"><span data-i18n="transferring">Transferring</span> <strong id="confirm_xmr"></strong> XMR <span data-i18n="to">to</span>:</div>
            <div class="dashboard-dialog-value-id" id="confirm_address" style="word-wrap: break-word; color: #D95700;"></div>
            <div class="dashboard-dialog-value-id" id="confirm_pid" style="word-wrap: break-word; color: #A1A1A1; font-size: 12px;"></div>
        </div>
        <div class="dashboard-dialog-buttons">
            <button id="button-dialog-cancel" class="btn btn-section">
                Cancel
            </button>
            <button id="button-dialog-send" class="btn btn-orange btn-orange--small">
                Send
            </button>
        </div>
    </dialog>
    
    <div class="dashboard-sync-progress">
        <div class="dashboard-sync-progress-bg">
            <div id="heightbar-left" class="bg-left"></div>
            <div id="heightbar-right" class="bg-right"></div>
        </div>
        <div class="dashboard-sync-progress-bar">
            <div id="heightbar" class="bar"></div>
        </div>
        <div id="heightbartext" class="dashboard-sync-progress-text"></div>
    </div>
    
    <script>
    current_page = 'send';
    
    if(old_syncing_height != '')
    {
        document.getElementById("heightbartext").innerHTML = old_syncing_height;
    }
    else
    {
        document.getElementById("heightbartext").innerHTML = 'syncing...';
    }
    
    function setHeightNar(progress)
    {
		var left = document.getElementById("heightbar-left"),
			right = document.getElementById("heightbar-right"),
			elem = document.getElementById("heightbar");
		left.style.width = progress + '%';
		right.style.width = 100 - progress + '%';
		elem.style.width = progress + '%';
    }
    
    function update_xmr_height_send()
    {
        if(session_id && current_page == 'send')
        {
            var beg = wallet_height_beg;
            var end = wallet_height_end;
            
            if(beg != 0 && end != 0)
            {
                if(end >= beg)
                {
                    var finalv = Math.ceil((beg / end)*100);
                    if(finalv > 100)
                    {
                        finalv = 100;
                    }
                    else if(((beg / end)*100) >= 99 && ((beg / end)*100) < 100)
                    {
                        finalv = 99;
                    }
                    setHeightNar(finalv);
                    var elem2 = document.getElementById("heightbartext");
                    var sprite = beg === end
                        ? '<span class="svg svg--status-checked"></span>'
                        : '<span class="svg svg--status-process"></span>';
                    old_syncing_height = sprite + ' Height (' + wallet_height_beg.toString() + '/' + wallet_height_end.toString() + ')';
                    elem2.innerHTML = old_syncing_height;
                }
            }  
            setTimeout(update_xmr_height_send, 1000);
        }
        else
        {
            setTimeout(update_xmr_height_send, 1000);
        }
    }
    if(xmr_updating_height_send == 0)
    {   
        xmr_updating_height_send = 1;
        update_xmr_height_send();
    }
    </script>
    
    <div class="dashboard-panel">
        <div class="dashboard-panel-header">
            <div class="dashboard-panel-header-title">
                <span class="svg svg--send-white"></span>
                <span class="title-text"><span data-i18n="send_funds">Send funds</span></span>
            </div>
        </div>
        <div id="tsent" class="dashboard-panel-header" style="text-align: center; display: none;"><span style="color: #30D930;margin: 0 auto;">Transaction Sent!</span></div>
        <div class="dashboard-panel-body">
            <div class="form-group">
                <label class="label"><span data-i18n="receiver_address">Receiver Address</span></label>
                <input id="send_address" type="text" class="form-control" placeholder="" data-i18n-key="receiver_address_placeholder" data-i18n-name="placeholder" />
            </div>
            <div class="row">
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="label">XMR Amount</label>
                        <div class="input-group input-group--monero">
                            <input id="send_xmr" oninput="setsendingmaxxmr(0)" type="text" class="form-control" placeholder="0"/>
                            <div class="svg svg--monero-white" style="margin-top: 2px;"></div>
                            <div class="input-group-btn">
                                <button id="xmr_max" class="btn btn-group btn-group--text"><span data-i18n="max">Max</span></button>
                                <script>
                                var sending_max = 0;
                                var sending_max_fees = JSBigInt('0');
                                var last_xmr_send = "0";
                                var last_usd_send = "0";
                                var max_sending_val = "0";
                                function setsendingmax(val)
                                {
                                    sending_max = val;
                                }
                                function setsendingmaxxmr(val)
                                {
                                    sending_max = val;
                                    var check_amount = $("#send_xmr").val();
                                    var check_amount_valid = 1;
                                    var total_dots = 0;
                                    if(check_amount.length == 0)
                                    {
                                        last_xmr_send = "0";
                                        last_usd_send = "0";
                                        $("#send_xmr").val("");
                                        $("#send_usd").val("");
                                    }
                                    else if(check_amount.length >= 16 && val == 0)
                                    {
                                        if(check_amount.length < last_xmr_send.length)
                                        {
                                            last_xmr_send = $("#send_xmr").val();
                                            var lastChar = last_xmr_send.substr(last_xmr_send.length - 1);
                                            if(lastChar == '.')
                                            {
                                                last_xmr_send = last_xmr_send.substring(0, last_xmr_send.length - 1);
                                                $("#send_xmr").val(last_xmr_send);
                                            }
                                        }
                                        else
                                        {
                                            check_amount_valid = 0;
                                        }
                                    }
                                    else
                                    {
                                        for(var v = 0; v < check_amount.length; v++)
                                        {
                                            if(check_amount[v] >= '0' && check_amount[v] <= '9')
                                            {
                                                
                                            }
                                            else if(check_amount[v] == '.')
                                            {
                                                if(total_dots == 0)
                                                {
                                                    total_dots++;
                                                }
                                                else
                                                {
                                                    check_amount_valid = 0;
                                                    break;
                                                }
                                            }
                                            else
                                            {
                                                check_amount_valid = 0;
                                                break;
                                            }
                                        }
                                    }
                                    if(check_amount_valid == 0)
                                    {
                                        $("#send_xmr").val(last_xmr_send);
                                        $("#send_usd").val(last_usd_send);
                                    }
                                    else
                                    {
                                        if(last_usd_value_real)
                                        {
                                            last_xmr_send = $("#send_xmr").val();
                                            last_usd_send = (parseFloat(last_xmr_send)*last_usd_value_real).toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2}).replace(/,/g, "");
                                            $("#send_usd").val(last_usd_send);
                                        }
                                        else
                                        {
                                            $("#send_xmr").val(last_xmr_send);
                                            $("#send_usd").val(last_usd_send);
                                        }
                                    }
                                }
                                function setsendingmaxusd(val)
                                {
                                    sending_max = val;
                                    var check_amount = $("#send_usd").val();
                                    var check_amount_valid = 1;
                                    var total_dots = 0;
                                    if(check_amount.length == 0)
                                    {
                                        last_xmr_send = "0";
                                        last_usd_send = "0";
                                        $("#send_xmr").val("");
                                        $("#send_usd").val("");
                                    }
                                    else if(check_amount.length >= 16 && val == 0)
                                    {
                                        if(check_amount.length < last_usd_send.length)
                                        {
                                            last_usd_send = $("#send_usd").val();
                                            var lastChar = last_usd_send.substr(last_usd_send.length - 1);
                                            if(lastChar == '.')
                                            {
                                                last_usd_send = last_usd_send.substring(0, last_usd_send.length - 1);
                                                $("#send_usd").val(last_usd_send);
                                            }
                                        }
                                        else
                                        {
                                            check_amount_valid = 0;
                                        }
                                    }
                                    else
                                    {
                                        for(var v = 0; v < check_amount.length; v++)
                                        {
                                            if(check_amount[v] >= '0' && check_amount[v] <= '9')
                                            {
                                                
                                            }
                                            else if(check_amount[v] == '.')
                                            {
                                                if(total_dots == 0)
                                                {
                                                    total_dots++;
                                                }
                                                else
                                                {
                                                    check_amount_valid = 0;
                                                    break;
                                                }
                                            }
                                            else
                                            {
                                                check_amount_valid = 0;
                                                break;
                                            }
                                        }
                                    }
                                    if(check_amount_valid == 0)
                                    {
                                        $("#send_xmr").val(last_xmr_send);
                                        $("#send_usd").val(last_usd_send);
                                    }
                                    else
                                    {
                                        if(last_usd_value_real)
                                        {
                                            last_usd_send = $("#send_usd").val();
                                            last_xmr_send = (parseFloat(last_usd_send) / last_usd_value_real).toString();
                                            $("#send_xmr").val(last_xmr_send);
                                        }
                                        else
                                        {
                                            $("#send_xmr").val(last_xmr_send);
                                            $("#send_usd").val(last_usd_send);
                                        }
                                    }
                                }
                                $("#xmr_max").unbind().click(function(event) {
                                   event.preventDefault();
                                   account_timeout = new Date().getTime();
                                   
                                   $.ajax({
                                    type: "POST",
                                    url: '/getfees.php',
                                    data: {
                                       session_id: session_id,
                                    }
                                        }).done(function(data){
                                        
                                        if(data == "0")
                                        {
                                            alert("Failed to get Fees info. Try again later...");
                                        }
                                        else
                                        {
                                            var fee_per_kb = JSBigInt(data);
                                            var required_fee = fee_per_kb.multiply(2);
                                            required_fee = JSBigInt(cnUtil.estimate_tx_size(1, 1, 10, 2, 0, 1) / 1024).multiply(required_fee);
                                            var showfinalbal = real_xmr_unlocked_balance;
                                            if(showfinalbal.compare("0") < 0)
                                            {
                                                showfinalbal = JSBigInt("0");
                                            }
                                            else
                                            {
                                                sending_max = 1;
                                                sending_max_fees = required_fee;
                                            }
                                            $("#send_xmr").val(moneroBalance(showfinalbal));
                                            max_sending_val =  $("#send_xmr").val();
                                            if(sending_max == 1)
                                            {
                                                setsendingmaxxmr(1);
                                            }
                                            $("#send_xmr").val("all balance");
                                        }
                                        
                                        }).fail(function(){
                                        
                                            alert("Failed to get Fees info. Try again later...");
                                            
                                            });
                                });
                                </script>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="label">USD Amount</label>
                        <div class="input-group input-group--monero" style="width: 100%;">
                            <input id="send_usd" oninput="setsendingmaxusd(0)" type="text" class="form-control" placeholder="0"/>
                            <div class="svg svg--usd-white" style="margin-top: 2px;"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row" style="display: none;">
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="label"><span data-i18n="label_payment_id">Payment ID (Optional)</span></label>
                        <input id="send_payment_id" type="text" class="form-control" placeholder="e.g. 473a2db4afec7bb0f89fac3a917ae5632763272f9..." }}/>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group">
                    </div>
                </div>
            </div>
            <!--
            <div class="form-group form-group-end">
                <label class="label"><span data-i18n="label_receiver_address">Transaction Privacy</span></label>
                <div class="select-style">
                    <select id="send_mixin">
                        <option value="1" selected>Normal (With 6 others)</option>
                        <option value="2">Medium (With 10 others)</option>
                        <option value="3">High (With 20 others)</option>
                        <option value="4">Extreme (With 40 others)</option>
                    </select>
                    <button class="btn btn-select">
                        <span class="svg svg--arrow-down"></span>
                    </button>
                </div>
            </div>
            -->
            <button id="sendpaymentbutton" class="btn btn-orange btn-lg" style="margin-top: 20px;"><span data-i18n="button_send_payment">SEND PAYMENT</span></button>
            <script>
            sendpaymentenabled = true;
            function sendpayment(){
            setTimeout(function(){
            if($('#sendpaymentbutton').hasClass("btn-grey"))
            {
                $('#sendpaymentbutton').html('<span data-i18n="button_send_payment">SEND PAYMENT</span>');
                $("#sendpaymentbutton").addClass("btn-orange").removeClass("btn-grey");
                sendpaymentenabled = true;
                $('#sendpaymentbutton').prop('disabled', false);
            }
            $("#sendpaymentbutton").one('click', function(event) {
                event.preventDefault();
                
                if(wallet_height_beg != wallet_height_end)
                {
                    alert("Your wallet is not fully synced yet, please wait...");
                    sendpayment();
                    return;
                }
                
                account_timeout = new Date().getTime();
                if(sendpaymentenabled == false)
                {
                    sendpayment();
                    return;
                }
                $('#sendpaymentbutton').prop('disabled', true);
                sendpaymentenabled = false;
                $("#sendpaymentbutton").addClass("btn-grey").removeClass("btn-orange");
                
                var isallbal = 0;
                
                if($("#send_xmr").val() == "all balance")
                {
                    isallbal = 1;
                }
                
                if(isNaN($("#send_xmr").val()))
                {
                   if(isallbal == 0)
                   {
                       alert("Invalid amount (1)");
                       sendpayment();
                       return;
                   }
                }
                
                if(isallbal == 0)
                {
                    tempamount = $("#send_xmr").val();
                }
                else
                {
                    tempamount = max_sending_val;
                }
                
                tempamount = tempamount.trim();
                try
                {
                   tempamount = cnUtil.parseMoney(tempamount);
                }
                catch(e)
                {
                   alert("Invalid amount (90)");
                   sendpayment();
                   return; 
                }
                
                transaction_amount = new JSBigInt(tempamount);
                transaction_address = $("#send_address").val();
                transaction_payment_id = $("#send_payment_id").val();
                transaction_mixin = "1"; //$("#send_mixin").val();
                var pid_encrypt = false;
                
                if(transaction_address)
                {
                    transaction_address = transaction_address.trim();
                }
                
                if(transaction_payment_id)
                {
                    transaction_payment_id = transaction_payment_id.trim();
                }

                if(transaction_mixin == "1")
                {
                    transaction_mixin = 10;
                }
                else if(transaction_mixin == "2")
                {
                    transaction_mixin = 10;
                }
                else if(transaction_mixin == "3")
                {
                    transaction_mixin = 20;
                }
                else if(transaction_mixin == "4")
                {
                    transaction_mixin = 40;
                }
                else
                {
                    transaction_mixin = 6;
                }

                if(!transaction_address)
                {
                    alert("Invalid Monero address");
                    sendpayment();
                    return;
                }

                if(transaction_amount.compare(real_xmr_unlocked_balance.subtract(real_xmr_unlocked_balance_pending)) > 0)
                {
                    if(transaction_amount.compare(real_xmr_balance.subtract(real_xmr_balance_pending)) > 0)
                    {
                        alert("The amount you've entered is too high.");
                        sendpayment();
                        return;
                    }
                    else
                    {
                        //alert("Your unlocked balance is not high enough. Please wait for more confirmations on your latest transaction(s).");
                    }
                }

                if(transaction_amount.compare("0") <= 0)
                {
                    alert("Invalid amount (2)");
                    sendpayment();
                    return;
                }

                if(transaction_address.indexOf('.') !== -1)
                {
                    alert("Domain address are not yet supported");
                    sendpayment();
                    return;
                }
                
                if (transaction_payment_id && (transaction_payment_id.length !== 64 || !(/^[0-9a-fA-F]{64}$/.test(transaction_payment_id))))
                {  
                   alert("Invalid payment id");
                   sendpayment();
                   return;
                }

                try
                {
                   var decode_result = cnUtil.decode_address(transaction_address);
                   if (decode_result.intPaymentId && transaction_payment_id)
                   {
                     alert("Payment ID field must be blank when using an Integrated Address");
                     sendpayment();
                     return;
                   }
                   else if (decode_result.intPaymentId)
                   {
                     transaction_payment_id = decode_result.intPaymentId;
                     pid_encrypt = true;
                   }
                }
                catch (e)
                {
                   alert(transaction_address + " is an invalid Monero address");
                   sendpayment();
                   return;
                }

                $('#sendpaymentbutton').html('&nbsp;<img src="i/loadingaccount.svg" alt="generating transaction..." style="position: absolute; margin-top: -44px; margin-left: -55px;">');
                
                var getunspentoutstries = 0;
                
                function getunspentouts()
                {
                
                    getunspentoutstries++; 
                    
                    if(getunspentoutstries > 1)
                    {
                        alert("Failed to generate transaction...We will try to re-sync your account, if that doesn't fix the issue, please contact our support team.");
                        sendpayment();
                        return;
                    }
                
                    $.ajax({
                        type: "POST",
                        url: '/getunspentoutputs.php',
                        data: {
                           session_id: session_id,
                        }
                    }).done(function(data){
                    
                           if(data == 0)
                           {
                                getunspentouts();
                                return;
                           }
                    
                           function processpayment1(unspentdata)
                           {
                               var output_data = JSON.parse(unspentdata);
                           
                               if(output_data)
                               {
                                    var dust_threshold = new JSBigInt('10000000000');
                                    
                                    var destinations = [];
                                    destinations.push({});
                                    destinations[destinations.length-1].address = transaction_address;
                                    destinations[destinations.length-1].amount = transaction_amount;
                                    
                                    var unspent_outputs = [];
                                    for(var i = 1; i < output_data.length; i++)
                                    {
                                        unspent_outputs.push(output_data[i]);
                                    }
                                    
                                    if(unspent_outputs.length <= 0)
                                    {
                                        alert("No available outputs");
                                        sendpayment();
                                        return;
                                    }
                                    
                                    var fee_per_kb = JSBigInt(output_data[0]);
                                    var rct = true;
                                    
                                    var required_fee = rct ? fee_per_kb.multiply(2) : fee_per_kb;
                                    
                                    if(sending_max == 1)
                                    {
                                        required_fee = sending_max_fees;
                                    }
                                    
                                    var final_amount = transaction_amount.add(required_fee);

                                    output_amount = new JSBigInt(0);
                                    output_using = [];
                                    
                                    function random_index(list)
                                    {
                                        return Math.floor(Math.random() * list.length);
                                    }
                                    
                                    function pop_random_value(list)
                                    {
                                        var idx = random_index(list);
                                        var val = list[idx];
                                        list.splice(idx, 1);
                                        return val;
                                    }
                                    
                                    while (output_amount.compare(final_amount) < 0 && unspent_outputs.length > 0)
                                    {
                                        var out = pop_random_value(unspent_outputs);
                                        if (!rct && out.m_rct == "01") {continue;}
                                        output_using.push(out);
                                        output_amount = output_amount.add(out.m_amount);
                                    }

                                    if (output_using.length > 1 && rct)
                                    {
                                        var newfee = JSBigInt(cnUtil.estimate_tx_size(1, 1, transaction_mixin, output_using.length, 0, 1) / 1024).multiply(fee_per_kb);
                                        if(sending_max == 1)
                                        {
                                            if(sending_max_fees.compare(newfee) > 0)
                                            {
                                                newfee = sending_max_fees;
                                            }
                                        }
                                        final_amount = transaction_amount.add(newfee);
                                        while (output_amount.compare(final_amount) < 0 && unspent_outputs.length > 0)
                                        {
                                            var out = pop_random_value(unspent_outputs);
                                            output_using.push(out);
                                            output_amount = output_amount.add(out.m_amount);
                                            newfee = JSBigInt(cnUtil.estimate_tx_size(1, 1, transaction_mixin, output_using.length, 0, 1) / 1024).multiply(fee_per_kb);
                                            if(sending_max == 1)
                                            {
                                                if(sending_max_fees.compare(newfee) > 0)
                                                {
                                                    newfee = sending_max_fees;
                                                }
                                            }
                                            final_amount = transaction_amount.add(newfee);
                                        }
                                        required_fee = newfee;
                                    }

                                    if (output_amount.compare(final_amount) < 0 && isallbal == 0)
                                    {
                                        alert("Not enough spendable outputs ("+moneroBalance(output_amount)+"/"+moneroBalance(final_amount)+")");
                                        sendpayment();
                                        return;
                                    }
                                    else if (output_amount.compare(final_amount) > 0)
                                    {
                                        var changeamount = output_amount.subtract(final_amount);
                                        if (!rct)
                                        {
                                            var changeamountdivrem = changeamount.divRem(dust_threshold);
                                            if (changeamountdivrem[0].toString() !== "0")
                                            {
                                                var usablechange = changeamountdivrem[0].multiply(dust_threshold);
                                                destinations.push({
                                                    address: xmrwallet_address,
                                                    amount: usablechange
                                                });
                                            }
                                        }
                                        else
                                        {
                                            destinations.push({address: xmrwallet_address, amount: changeamount});
                                        }
                                    }
                                    else if (output_amount.compare(final_amount) === 0 && rct)
                                    {
                                        var fakeaddress = cnUtil.create_address(cnUtil.random_scalar()).public_addr;
                                        destinations.push({
                                            address: fakeaddress,
                                            amount: 0
                                        });
                                    }

                                    if (transaction_mixin > 0)
                                    {
                                        var output_indexes = [];
                                        for (var l = 0; l < output_using.length; l++)
                                        {
                                            output_indexes.push(output_using[l].var_index);
                                        }
                                        
                                        $.ajax({
                                            type: "POST",
                                            url: '/getrandomoutputs.php',
                                            data: {
                                               session_id: session_id,
                                               outputindex: JSON.stringify(output_indexes),
                                               mixin: transaction_mixin + 1
                                            }
                                        }).done(function(data2){
                                                var signed_transaction;
                                                var mix_outputs = JSON.parse(data2);
                                                try
                                                {
                                                    dest_viewkey = null;
                                                    if (pid_encrypt)
                                                    {
                                                        var dest_viewkey = cnUtil.decode_address(destinations[0].address).view;
                                                    }
                                                    var splitted_destinations = cnUtil.decompose_tx_destinations(destinations, rct);
                                                    var pubkeys = {};
                                                    var seckeys = {};
                                                    pubkeys.view = main_keys.view.pub;
                                                    pubkeys.spend = main_keys.spend.pub;
                                                    seckeys.view = main_keys.view.sec;
                                                    seckeys.spend = main_keys.spend.sec;
                                                    signed_transaction = cnUtil.create_transaction(pubkeys, seckeys, splitted_destinations, output_using, mix_outputs, transaction_mixin, required_fee, transaction_payment_id, pid_encrypt, dest_viewkey, 0, rct);
                                                }
                                                catch (e)
                                                {
                                                    
                                                }
                                               
                                                var raw_tx_and_hash = {};
                                                raw_tx_and_hash.raw = 0; 

                                                tx_info = {};
                                                if(isallbal == 0)
                                                {
                                                    tx_info.amount = transaction_amount.toString();
                                                }
                                                else
                                                {
                                                    tx_info.amount = 'allbalance';
                                                }
                                                tx_info.address = destinations[0].address;
                                                if(transaction_payment_id)
                                                {
                                                    tx_info.payment_id = transaction_payment_id;
                                                }
                                                else
                                                {
                                                    tx_info.payment_id = '0000000000000000';
                                                }
                                                tx_info.fee = required_fee.toString();
                                                
                                                output_unamount = new JSBigInt(0);
                                                for (var l = 0; l < output_using.length; l++)
                                                {
                                                    output_unamount = output_amount.add(output_using[l].m_amount);
                                                }
                                                tx_info.unamount = output_unamount.toString();
                                               
                                                
                                                 $.ajax({
                                                    type: "POST",
                                                    url: '/submittransaction.php',
                                                    data: {
                                                       session_id: session_id,
                                                       tx: raw_tx_and_hash.raw,
                                                       tx_info: JSON.stringify(tx_info)
                                                    }
                                                }).done(function(data2, textStatus, jqXHR){ 
                                                        
                                                        if(jqXHR.status == 524)
                                                        {
                                                        }
                                                        else if(data2 != "1")
                                                        {
                                                            alert("Failed to submit transaction 2...please wait until your balance is unlocked.");
                                                            sendpayment();
                                                            return;
                                                        }
                                                        
                                                        $("#send_xmr").val("0");
                                                        $("#send_address").val("");
                                                        $("#send_payment_id").val("");
                                                        $("#send_usd").val("");
                                                        max_sending_val = "0";

                                                        update_transactions(0);
                                                        
                                                        var audio = new Audio('beep.mp3');
                                                        audio.play();
                                                        
                                                        $("#tsent").show();

                                                        sendpayment();
                                                       
                                                        
                                                }).fail(function (jqXHR, textStatus, error){
                                                   if(textStatus==="timeout" || jqXHR.status == 524) {
                                                        $("#send_xmr").val("0");
                                                        $("#send_address").val("");
                                                        $("#send_payment_id").val("");
                                                        $("#send_usd").val("");
                                                        max_sending_val = "0";

                                                        update_transactions(0);
                                                        
                                                        var audio = new Audio('beep.mp3');
                                                        audio.play();
                                                        
                                                        $("#tsent").show();
                                                   }
                                                   else
                                                   {
                                                    alert("Failed to submit transaction 3...please wait until your balance is unlocked. " + textStatus);
                                                    console.log(jqXHR.status);
                                                  }
                                                   sendpayment();
                                                   return;
                                                });
     
                                                
                                               }).fail(function(){ 
                                                 alert("Failed to get mixin outputs");
                                                 sendpayment();
                                                 return;
                                               });
                                    }
                                    else if (transaction_mixin <= 0 || isNaN(transaction_mixin))
                                    {
                                        alert("Invalid mixin");
                                        sendpayment();
                                        return;
                                    }
                                    else
                                    {
                                        alert("Unknown Error");
                                        sendpayment();
                                        return;
                                    }
                                }
                                else
                                {
                                    sendpayment();
                                    return;
                                }
                           }
                           
                           var dialog = document.getElementById('dialog_send');
                           document.getElementById('button-dialog-cancel').onclick = function() {
                                sendpayment();
                                dialog.close();
                           };
                           document.getElementById('button-dialog-send').onclick = function() {
                                processpayment1(data);
                                dialog.close();
                           };

                           $("#confirm_xmr").html($("#send_xmr").val().trim());
                           $("#confirm_address").html($("#send_address").val().trim());
                           if(transaction_payment_id)
                           {
                              $("#confirm_pid").html("#" + transaction_payment_id);
                           }
                           else
                           {
                              $("#confirm_pid").html("");
                           }
                           
                           dashboardShowModal('#dialog_send');
         
                    }).fail(function()
                    {
                        alert("Failed to generate transaction...try again later");
                        sendpayment();
                    });
                
                }
                
                getunspentouts();
               
            }); }, 1)};
            sendpayment();
            </script>
        </div>
    </div>
    <div id="pendingdiv" style="display: none;" class="dashboard-panel">
    <div class="dashboard-panel-header">
        <div class="dashboard-panel-header-title">
            <span class="svg svg--transacrions-white"></span>
            <span class="title-text">Pending Transactions</span>
        </div>
    </div>
    <div class="dashboard-panel-body">
        <table class="table table-offset">
            <thead>
            <tr>
                <td>Date</td>
                <td class="column-transaction"><span data-i18n="table_transaction_id">Transaction ID</span></td>
                <td>Confirm.</td>
                <td class="column-right"><span data-i18n="table_value_xmr">Value XMR</span></td>
            </tr>
            </thead>
            <tbody id="pendingtxdata">
            </tbody>
        </table>
    </div>
</div>


<script>
var current_time = XMR_DATE.getTime();

function update_transaction_data(data)
{
        
    var finaltxdata = '';
    var finalpendingtxdata = '';
    
    var unamount_total = new JSBigInt(0);
    var amount_total = new JSBigInt(0);

    for(var i = 1; i < data.length; i++)
    {
        var d = new Date(0);
        d.setUTCSeconds(parseInt(data[i]['time']));
        if(data[i]['type'] != 'pendingtx')
        {
            var datashowconfirm = data[i]['confirmations'];
            if(data[i]['type'] == 'in' && datashowconfirm == "10/10")
            {
                finaltxdata += '<tr class="data-status--received">';
            }
            else if(data[i]['type'] == 'in')
            {
                finaltxdata += '<tr class="data-status--checking">';
            }
            else if(data[i]['type'] == 'out')
            {
                finaltxdata += '<tr class="data-status--send">';
            }
            else if(data[i]['type'] == 'pool' || data[i]['type'] == 'pending')
            {
                finaltxdata += '<tr class="data-status--pending">';
                datashowconfirm = "0/10";
            }
            else if(data[i]['type'] == 'swept')
            {
                finaltxdata += '<tr class="data-status--send">';
            }
            finaltxdata += '<td data-label="Date received" data-i18n-key="table_date_received" data-i18n-name="data-label"><div class="data-received">' + d.toLocaleString() + '</div></td>';
            finaltxdata += '<td data-label="Transaction ID" data-i18n-key="table_transaction_id" data-i18n-name="data-label"><div class="data-id"><a target="_blank" ';
            if(data[i]['type'] == 'in')
            {
                finaltxdata += 'class="payment-received" ';
            }
            else if(data[i]['type'] == 'out')
            {
                finaltxdata += 'class="payment-sent" ';
            }
            else if(data[i]['type'] == 'swept')
            {
                finaltxdata += 'class="payment-swept" ';
            }
            else if(data[i]['type'] == 'pool' || data[i]['type'] == 'pending')
            {
                finaltxdata += 'class="payment-pool" ';
            }
            
            if(data[i]['type'] == 'swept')
            {
                data[i]['payment_id'] = '0000000000000000';
                //var txsplit = data[i]['txid'].split(":");
                //data[i]['txid'] = txsplit[0];
                data[i]['txid'] = 'Unknown transaction id (Swept Transaction)';
            }
            
            finaltxdata += 'href="https://xmrchain.net/search?value=' + data[i]['txid'] + '">' + data[i]['txid'] + '</a>';
            if(data[i]['payment_id'] != '0000000000000000')
            {
               finaltxdata += '<br><span style="font-size: 10px; color: #C9C9C9;">#' + data[i]['payment_id'] + '</span>'; 
            }
            finaltxdata += '</div></td>';
            if(datashowconfirm == "10/10")
            {
                datashowconfirm = "&#10004;";
            }
            finaltxdata += '<td data-label="Mixin" data-i18n-key="table_mixin" data-i18n-name="data-label"><div class="data-mixin">' + datashowconfirm + '</div></td>';
            finaltxdata += '<td data-label="Value XMR" data-i18n-key="table_value_xmr" data-i18n-name="data-label" class="column-right"><div class="data-value">';
            if(data[i]['type'] == 'in')
            {
                finaltxdata += '+';
            }
            else if(data[i]['type'] == 'out')
            {
                finaltxdata += '-';
            }
            else if(data[i]['type'] == 'pool' || data[i]['type'] == 'pending')
            {
                finaltxdata += '+';
            }
            else if(data[i]['type'] == 'swept')
            {
                finaltxdata += '-';
            }
            if(data[i]['amount'] != -1)
            {
                finaltxdata += moneroBalance(data[i]['amount']) + '</div></td>';
            }
            else
            {
                finaltxdata += 'Error</div></td>';
            }
            finaltxdata += '</tr>';
        }
        else
        {
            finalpendingtxdata += '<tr>';
            finalpendingtxdata += '<td style="font-size: 10px;">' + d.toLocaleString() + '</td>';
            finalpendingtxdata += '<td><a target="_blank" ';
            finalpendingtxdata += 'class="payment-pool" ';
            
            finalpendingtxdata += 'href="https://xmrchain.net/search?value=' + data[i]['txid'] + '">' + data[i]['txid'] + '</a>';
            if(data[i]['payment_id'] != '0000000000000000')
            {
               finalpendingtxdata += '<br><span style="font-size: 10px; color: #C9C9C9;">#' + data[i]['payment_id'] + '</span>'; 
            }
            finalpendingtxdata += '</td>';
            var datashowconfirm = data[i]['confirmations'];
            if(datashowconfirm == "10/10")
            {
                datashowconfirm = "&#10004;";
            }
            finalpendingtxdata += '<td>' + datashowconfirm + '</td>';
            finalpendingtxdata += '<td class="column-right">';
            finalpendingtxdata += '-';
            finalpendingtxdata += moneroBalance(data[i]['amount']) + '</td>';
            finalpendingtxdata += '</tr>';
            
            amount_total = amount_total.add(data[i]['amount']);
            amount_total = amount_total.add(data[i]['fee']);
            unamount_total = unamount_total.add(data[i]['unamount']);
            
        }
    }
    
        
    real_xmr_balance_pending = amount_total;
    real_xmr_unlocked_balance_pending = unamount_total;
    
    if(finalpendingtxdata)
    {
        $("#pendingtxdata").html(finalpendingtxdata);
        $("#pendingdiv").show();
    }
    else
    {
        $("#pendingdiv").hide();
    }
    
}

function update_transactions(with_timeout)
{
    transactions_updated_value = XMR_DATE.getTime();
        if(session_id && xmr_canget_transactions == 1 && document.getElementById("pendingtxdata") != null && wallet_height_beg == wallet_height_end && wallet_height_beg != 0)
    {
            $.ajax({
            type: "POST",
            url: '/gettransactions.php',
            data: {
               session_id: session_id,
               page: transaction_atpage,
               sort: 0
            }
        }).done(function(data){
                if(data != '0' && data != '1' && data != '')
                {
                    last_transactions = JSON.parse(data);
                    update_transaction_data(last_transactions);
                    if(with_timeout == 1)
                    {
                        setTimeout(function(){ update_transactions(1) }, 10000);
                    }
                }
                else
                {
                    if(with_timeout == 1)
                    {
                        setTimeout(function(){ update_transactions(1) }, 1000);
                    }
                }
            }).fail(function()
            {
                if(with_timeout == 1)
                { 
                    setTimeout(function(){ update_transactions(1) }, 1000);
                }
            });
    }
    else
    {
        if(with_timeout == 1)
        {
            setTimeout(function(){ update_transactions(1) }, 1000);
        }
    }
}
if(xmr_alreadyupdating_value == 0)
{
    xmr_alreadyupdating_value = 1;
    update_transactions(1);
}
else
{
    if(last_transactions)
    {
        update_transaction_data(last_transactions);
    }
}
</script>                </div>
            </div>
            <div class="dashboard-footer">
                <div class="dashboard-footer-links">
                    <select class="js-select-footer" name="">
                                                    <option selected value="en">English</option>
                                                    <option  value="fr">French</option>
                                                    <option  value="ru">Russian</option>
                                                    <option  value="ch_Sm">Chinese Simplified</option>
                                                    <option  value="jp">Japanese</option>
                                                    <option  value="it">Italian</option>
                                                    <option  value="bu">Dutch</option>
                                                    <option  value="ge">German</option>
                                                    <option  value="pr">Porteugese</option>
                                                    <option  value="sp">Spanish</option>
                                            </select>
																	<a href="#/terms_login.html"><span data-i18n="terms_of_use">Terms of Use</span></a>
						<a href="#/policy_login.html"><span data-i18n="privacy_policy">Privacy Policy</span></a>
						                        <a target="_blank" href="https://github.com/XMRWallet">GitHub</a>
                        <a target="_blank" href="https://twitter.com/xmrwalletcom">Twitter</a>
					                </div>
                
                <div class="dashboard-footer-copy"> 2018-2024 XMRWALLET.COM <span style="position: relative; color: #fff; left: 3px; font-size: 12px; font-weight: bold; background-color: #383F4D; padding: 6px;">v0.18.0.0</span></div>
            </div>
        </div>
    </div>
</div>